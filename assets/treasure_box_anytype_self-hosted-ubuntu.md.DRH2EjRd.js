import{_ as n,c as a,o as p,ae as e}from"./chunks/framework.BHrE6nLq.js";const c="/images/treasure_box/anytype/anytype_setting.png",o="/images/treasure_box/anytype/sync.png",g=JSON.parse('{"title":"anytype 自托管 (ubuntu)","description":"","frontmatter":{},"headers":[],"relativePath":"treasure_box/anytype/self-hosted-ubuntu.md","filePath":"treasure_box/anytype/self-hosted-ubuntu.md"}'),t={name:"treasure_box/anytype/self-hosted-ubuntu.md"};function l(i,s,d,r,u,y){return p(),a("div",null,s[0]||(s[0]=[e(`<h1 id="anytype-自托管-ubuntu" tabindex="-1">anytype 自托管 (ubuntu) <a class="header-anchor" href="#anytype-自托管-ubuntu" aria-label="Permalink to &quot;anytype 自托管 (ubuntu)&quot;">​</a></h1><blockquote><p><a href="https://doc.anytype.io/anytype-docs/advanced/data-and-security/self-hosting/self-hosted" target="_blank" rel="noreferrer">https://doc.anytype.io/anytype-docs/advanced/data-and-security/self-hosting/self-hosted</a></p></blockquote><h2 id="先决条件安装工具" tabindex="-1">先决条件安装工具 <a class="header-anchor" href="#先决条件安装工具" aria-label="Permalink to &quot;先决条件安装工具&quot;">​</a></h2><blockquote><p><a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noreferrer">https://docs.docker.com/engine/install/ubuntu/</a></p></blockquote><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>第一步</span></span>
<span class="line"><span># Add Docker&#39;s official GPG key:</span></span>
<span class="line"><span>sudo apt-get update</span></span>
<span class="line"><span>sudo apt-get install ca-certificates curl</span></span>
<span class="line"><span>sudo install -m 0755 -d /etc/apt/keyrings</span></span>
<span class="line"><span>sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc</span></span>
<span class="line"><span>sudo chmod a+r /etc/apt/keyrings/docker.asc</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Add the repository to Apt sources:</span></span>
<span class="line"><span>echo \\</span></span>
<span class="line"><span>  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\</span></span>
<span class="line"><span>  $(. /etc/os-release &amp;&amp; echo &quot;\${UBUNTU_CODENAME:-$VERSION_CODENAME}&quot;) stable&quot; | \\</span></span>
<span class="line"><span>  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span></span>
<span class="line"><span>sudo apt-get update</span></span>
<span class="line"><span>第二步</span></span>
<span class="line"><span>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span></span>
<span class="line"><span></span></span>
<span class="line"><span>第三步 测试可以忽略</span></span>
<span class="line"><span>sudo docker run hello-world</span></span></code></pre></div><h2 id="自托管服务-dockercompose" tabindex="-1">自托管服务(dockercompose) <a class="header-anchor" href="#自托管服务-dockercompose" aria-label="Permalink to &quot;自托管服务(dockercompose)&quot;">​</a></h2><blockquote><p><a href="https://github.com/anyproto/any-sync-dockercompose" target="_blank" rel="noreferrer">https://github.com/anyproto/any-sync-dockercompose</a></p></blockquote><ul><li>修改配置文件启动容器</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sudo apt install make </span></span>
<span class="line"><span>git clone https://github.com/anyproto/any-sync-dockercompose.git</span></span>
<span class="line"><span>cd any-sync-dockercompose</span></span>
<span class="line"><span>echo &#39;EXTERNAL_LISTEN_HOSTS=192.168.170.134&#39; &gt;&gt; .env.override</span></span>
<span class="line"><span>sudo make start</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 成功后项目目录下自动生成 etc 目录下载 client.yml 文件</span></span>
<span class="line"><span>root@ubuntu:/home/ubuntu/any-sync-dockercompose/etc# ls</span></span>
<span class="line"><span>any-sync-consensusnode  any-sync-filenode  any-sync-node-2  client.yml</span></span>
<span class="line"><span>any-sync-coordinator    any-sync-node-1    any-sync-node-3</span></span></code></pre></div><ul><li>检查容器状态</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ubuntu@ubuntu:~$ sudo docker ps</span></span>
<span class="line"><span>CONTAINER ID   IMAGE                                            COMMAND                  CREATED        STATUS                  PORTS                                                                                                                                                   NAMES</span></span>
<span class="line"><span>9e8ce49475f4   ghcr.io/anyproto/any-sync-tools:latest           &quot;tail -f /dev/null&quot;      13 hours ago   Up 13 hours (healthy)   443/tcp, 8000/tcp, 8080/tcp                                                                                                                             any-sync-dockercompose-netcheck-1</span></span>
<span class="line"><span>3f7555c956b0   ghcr.io/anyproto/any-sync-node:v0.7.6            &quot;/bin/any-sync-node …&quot;   13 hours ago   Up 13 hours             443/tcp, 0.0.0.0:1003-&gt;1003/tcp, [::]:1003-&gt;1003/tcp, 0.0.0.0:1013-&gt;1013/udp, [::]:1013-&gt;1013/udp, 127.0.0.1:8003-&gt;8000/tcp, 127.0.0.1:8083-&gt;8080/tcp   any-sync-dockercompose-any-sync-node-3-1</span></span>
<span class="line"><span>c97d7ab160b4   ghcr.io/anyproto/any-sync-node:v0.7.6            &quot;/bin/any-sync-node …&quot;   13 hours ago   Up 13 hours             443/tcp, 0.0.0.0:1001-&gt;1001/tcp, [::]:1001-&gt;1001/tcp, 0.0.0.0:1011-&gt;1011/udp, [::]:1011-&gt;1011/udp, 127.0.0.1:8001-&gt;8000/tcp, 127.0.0.1:8081-&gt;8080/tcp   any-sync-dockercompose-any-sync-node-1-1</span></span>
<span class="line"><span>1511054afd5a   ghcr.io/anyproto/any-sync-consensusnode:v0.2.3   &quot;/bin/any-sync-conse…&quot;   13 hours ago   Up 13 hours             443/tcp, 8080/tcp, 0.0.0.0:1006-&gt;1006/tcp, [::]:1006-&gt;1006/tcp, 0.0.0.0:1016-&gt;1016/udp, [::]:1016-&gt;1016/udp, 127.0.0.1:8006-&gt;8000/tcp                   any-sync-dockercompose-any-sync-consensusnode-1</span></span>
<span class="line"><span>ed16b1e0d293   ghcr.io/anyproto/any-sync-filenode:v0.8.7        &quot;/bin/any-sync-filen…&quot;   13 hours ago   Up 13 hours             443/tcp, 8080/tcp, 0.0.0.0:1005-&gt;1005/tcp, [::]:1005-&gt;1005/tcp, 0.0.0.0:1015-&gt;1015/udp, [::]:1015-&gt;1015/udp, 127.0.0.1:8005-&gt;8000/tcp                   any-sync-dockercompose-any-sync-filenode-1</span></span>
<span class="line"><span>50fca9a1e066   ghcr.io/anyproto/any-sync-node:v0.7.6            &quot;/bin/any-sync-node …&quot;   13 hours ago   Up 13 hours             443/tcp, 0.0.0.0:1002-&gt;1002/tcp, [::]:1002-&gt;1002/tcp, 0.0.0.0:1012-&gt;1012/udp, [::]:1012-&gt;1012/udp, 127.0.0.1:8002-&gt;8000/tcp, 127.0.0.1:8082-&gt;8080/tcp   any-sync-dockercompose-any-sync-node-2-1</span></span>
<span class="line"><span>c8231c3e92ed   ghcr.io/anyproto/any-sync-coordinator:v0.5.1     &quot;/bin/any-sync-coord…&quot;   13 hours ago   Up 13 hours             443/tcp, 8080/tcp, 0.0.0.0:1004-&gt;1004/tcp, [::]:1004-&gt;1004/tcp, 0.0.0.0:1014-&gt;1014/udp, [::]:1014-&gt;1014/udp, 127.0.0.1:8004-&gt;8000/tcp                   any-sync-dockercompose-any-sync-coordinator-1</span></span>
<span class="line"><span>13806aa46cc4   redis/redis-stack-server:7.2.0-v6                &quot;redis-server --port…&quot;   13 hours ago   Up 13 hours (healthy)   127.0.0.1:6379-&gt;6379/tcp                                                                                                                                any-sync-dockercompose-redis-1</span></span>
<span class="line"><span>7dbfa952d616   mongo:7.0.2                                      &quot;docker-entrypoint.s…&quot;   13 hours ago   Up 13 hours (healthy)   127.0.0.1:27001-&gt;27001/tcp, 27017/tcp                                                                                                                   any-sync-dockercompose-mongo-1-1</span></span>
<span class="line"><span>8aa5c61adabf   minio/minio:RELEASE.2024-07-04T14-25-45Z         &quot;/usr/bin/docker-ent…&quot;   13 hours ago   Up 13 hours (healthy)   9000/tcp, 127.0.0.1:9001-&gt;9001/tcp                                                                                                                      any-sync-dockercompose-minio-1</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>docker 国内镜像站大部分停用 <code>sudo make start</code> 很可能失败，请自行想办法解决。</p></div><h2 id="客户端配置" tabindex="-1">客户端配置 <a class="header-anchor" href="#客户端配置" aria-label="Permalink to &quot;客户端配置&quot;">​</a></h2><p>下载 client.yml 配置客户端加载 client.yml</p><p>默认存储路径</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>C:\\Users\\Seven\\AppData\\Roaming\\anytype</span></span></code></pre></div><p><img src="`+c+`" alt="自托管设置"></p><ul><li>client.yml 配置文件</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>id: 684aa48e173bb90017f0b90e</span></span>
<span class="line"><span>networkId: N73V4cBzwLxRgcw7ZWVhuJdJKtAtPq6gCpCXPUM7Wi17VbeH</span></span>
<span class="line"><span>nodes:</span></span>
<span class="line"><span>  - addresses:</span></span>
<span class="line"><span>      - any-sync-node-1:1001</span></span>
<span class="line"><span>      - quic://any-sync-node-1:1011</span></span>
<span class="line"><span>      - 192.168.170.134:1001</span></span>
<span class="line"><span>      - quic://192.168.170.134:1011</span></span>
<span class="line"><span>      - 127.0.0.1:1001</span></span>
<span class="line"><span>      - quic://127.0.0.1:1011</span></span>
<span class="line"><span>    peerId: 12D3KooWBNiQB6rMRS4u2pJ2ojYNBtvoAJKsidXX947D5pyuUFxp</span></span>
<span class="line"><span>    types:</span></span>
<span class="line"><span>      - tree</span></span>
<span class="line"><span>  - addresses:</span></span>
<span class="line"><span>      - any-sync-node-2:1002</span></span>
<span class="line"><span>      - quic://any-sync-node-2:1012</span></span>
<span class="line"><span>      - 192.168.170.134:1002</span></span>
<span class="line"><span>      - quic://192.168.170.134:1012</span></span>
<span class="line"><span>      - 127.0.0.1:1002</span></span>
<span class="line"><span>      - quic://127.0.0.1:1012</span></span>
<span class="line"><span>    peerId: 12D3KooWNmfWL8TZoHVkZZJghydazJGu4uzkpWYp5p2WLRwMCN6U</span></span>
<span class="line"><span>    types:</span></span>
<span class="line"><span>      - tree</span></span>
<span class="line"><span>  - addresses:</span></span>
<span class="line"><span>      - any-sync-node-3:1003</span></span>
<span class="line"><span>      - quic://any-sync-node-3:1013</span></span>
<span class="line"><span>      - 192.168.170.134:1003</span></span>
<span class="line"><span>      - quic://192.168.170.134:1013</span></span>
<span class="line"><span>      - 127.0.0.1:1003</span></span>
<span class="line"><span>      - quic://127.0.0.1:1013</span></span>
<span class="line"><span>    peerId: 12D3KooWQj6wMwszH4urnkoxGHKUrhjq6o5seYT74PdTfmBjcR9q</span></span>
<span class="line"><span>    types:</span></span>
<span class="line"><span>      - tree</span></span>
<span class="line"><span>  - addresses:</span></span>
<span class="line"><span>      - any-sync-coordinator:1004</span></span>
<span class="line"><span>      - quic://any-sync-coordinator:1014</span></span>
<span class="line"><span>      - 192.168.170.134:1004</span></span>
<span class="line"><span>      - quic://192.168.170.134:1014</span></span>
<span class="line"><span>      - 127.0.0.1:1004</span></span>
<span class="line"><span>      - quic://127.0.0.1:1014</span></span>
<span class="line"><span>    peerId: 12D3KooWAzQ9GBVqmKPuWUhXL6vwrsPsrU8Mdc4iGR9pTVKcUHF9</span></span>
<span class="line"><span>    types:</span></span>
<span class="line"><span>      - coordinator</span></span>
<span class="line"><span>  - addresses:</span></span>
<span class="line"><span>      - any-sync-filenode:1005</span></span>
<span class="line"><span>      - quic://any-sync-filenode:1015</span></span>
<span class="line"><span>      - 192.168.170.134:1005</span></span>
<span class="line"><span>      - quic://192.168.170.134:1015</span></span>
<span class="line"><span>      - 127.0.0.1:1005</span></span>
<span class="line"><span>      - quic://127.0.0.1:1015</span></span>
<span class="line"><span>    peerId: 12D3KooWAsahpaE7pyK2PpzADhD6M4byUJeN4pPuLWcLqTzmkZSn</span></span>
<span class="line"><span>    types:</span></span>
<span class="line"><span>      - file</span></span>
<span class="line"><span>  - addresses:</span></span>
<span class="line"><span>      - any-sync-consensusnode:1006</span></span>
<span class="line"><span>      - quic://any-sync-consensusnode:1016</span></span>
<span class="line"><span>      - 192.168.170.134:1006</span></span>
<span class="line"><span>      - quic://192.168.170.134:1016</span></span>
<span class="line"><span>      - 127.0.0.1:1006</span></span>
<span class="line"><span>      - quic://127.0.0.1:1016</span></span>
<span class="line"><span>    peerId: 12D3KooWFqdzozm18ApKYEr6QdmpytDR7Njnj9mFc4LN6dFayAzB</span></span>
<span class="line"><span>    types:</span></span>
<span class="line"><span>      - consensus</span></span></code></pre></div><ul><li>登录查看网络验证</li></ul><p><img src="`+o+'" alt="自托管设置"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>注意：在自托管网络需要单独新助记词，两个网络不能互通无法使用之前的助记词。</p></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>CPU 支持 AVX 指令集，因为默认 MongoDB 用的是 MONGO_VERSION=7.0.2。如果降低 MONGO_VERSION 有不兼容。所以 CPU 不支持 AVX 指令集，无法使用自托管模式。</p></div>',23)]))}const b=n(t,[["render",l]]);export{g as __pageData,b as default};
