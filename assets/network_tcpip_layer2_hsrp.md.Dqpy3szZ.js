import{_ as a,c as t,o as i,ae as r}from"./chunks/framework.BHrE6nLq.js";const e="/images/tcpip/layer2/hsrp_hello.png",o="/images/tcpip/layer2/hsrp_hello_detail.png",s="/images/tcpip/layer2/hsrp_v2.png",n="/images/tcpip/layer2/hsrp_topology.png",h="/images/tcpip/layer2/hsrp_resign.png",S=JSON.parse('{"title":"HSRP","description":"","frontmatter":{},"headers":[],"relativePath":"network/tcpip/layer2/hsrp.md","filePath":"network/tcpip/layer2/hsrp.md"}'),p={name:"network/tcpip/layer2/hsrp.md"};function c(d,l,u,P,g,_){return i(),t("div",null,l[0]||(l[0]=[r('<h1 id="hsrp" tabindex="-1">HSRP <a class="header-anchor" href="#hsrp" aria-label="Permalink to &quot;HSRP&quot;">​</a></h1><p>HSRP（Hot Standby Router Protocol，热备份路由器协议）是 Cisco 平台专有的一种协议，封装在 UDP 协议中。</p><h3 id="hsrp-简介" tabindex="-1">HSRP 简介 <a class="header-anchor" href="#hsrp-简介" aria-label="Permalink to &quot;HSRP 简介&quot;">​</a></h3><p>HSRP 使用一个 HSRP 组，其中多台路由器负责提供冗余路由服务。</p><ul><li><strong>Active 路由器</strong>：负责转发用户流量。</li><li><strong>Standby 路由器</strong>：当 Active 路由器失效时，接替其角色。</li></ul><h3 id="hsrp-报文类型" tabindex="-1">HSRP 报文类型 <a class="header-anchor" href="#hsrp-报文类型" aria-label="Permalink to &quot;HSRP 报文类型&quot;">​</a></h3><ul><li><strong>Hello</strong>：用于发送路由器的 HSRP 优先级和状态信息，默认每 3 秒发送一次。</li><li><strong>Coup</strong>：备用路由器成为 Active 路由器时发送。</li><li><strong>Resign</strong>：当前 Active 路由器宕机或遇到优先级更高的路由器时发送。</li></ul><h3 id="hsrp-路由器状态" tabindex="-1">HSRP 路由器状态 <a class="header-anchor" href="#hsrp-路由器状态" aria-label="Permalink to &quot;HSRP 路由器状态&quot;">​</a></h3><p>配置了 HSRP 的路由器可处于以下六种状态之一：</p><ol><li><strong>Initial</strong>：HSRP 启动时的初始状态，尚未运行。</li><li><strong>Learn</strong>：学习状态，未获取虚拟 IP 地址，未收到 Active 路由器的 Hello 报文。</li><li><strong>Listen</strong>：已获得虚拟 IP 地址，但不是 Active 或 Standby 路由器。</li><li><strong>Speak</strong>：路由器定期发送 Hello 报文，参与 Active 和 Standby 的竞选。</li><li><strong>Standby</strong>：为接替 Active 路由器做好准备。</li><li><strong>Active</strong>：当前负责转发数据包。</li></ol><h3 id="hsrp-报文分析" tabindex="-1">HSRP 报文分析 <a class="header-anchor" href="#hsrp-报文分析" aria-label="Permalink to &quot;HSRP 报文分析&quot;">​</a></h3><h4 id="_1-hello-报文" tabindex="-1">1. Hello 报文 <a class="header-anchor" href="#_1-hello-报文" aria-label="Permalink to &quot;1. Hello 报文&quot;">​</a></h4><ul><li>Active 和 Standby 路由器每 3 秒发送一个 Hello 报文，发送到组播地址 224.0.0.2，使用 UDP 端口 1985（版本 1）。</li></ul><p><img src="'+e+'" alt="hsrp_hello"></p><h4 id="_2-版本-0-报文" tabindex="-1">2. 版本 0 报文 <a class="header-anchor" href="#_2-版本-0-报文" aria-label="Permalink to &quot;2. 版本 0 报文&quot;">​</a></h4><ul><li>发送到组播地址 224.0.0.2，使用 UDP 端口 1985，状态为 Active，默认认证为 &quot;cisco&quot;，虚拟 IP 地址为 10.10.10.1。</li></ul><p><img src="'+o+'" alt="hsrp_hello_detail"></p><h4 id="_3-版本-2-报文" tabindex="-1">3. 版本 2 报文 <a class="header-anchor" href="#_3-版本-2-报文" aria-label="Permalink to &quot;3. 版本 2 报文&quot;">​</a></h4><ul><li>组播地址变为 224.0.0.102</li></ul><p><img src="'+s+'" alt="hsrp_v2"></p><h3 id="hsrp-选举规则" tabindex="-1">HSRP 选举规则 <a class="header-anchor" href="#hsrp-选举规则" aria-label="Permalink to &quot;HSRP 选举规则&quot;">​</a></h3><ul><li>HSRP 组内会选出一个 Active 路由器，选举优先级依据： <ol><li><strong>优先级</strong>：数值越大，优先级越高，默认值为 100。</li><li><strong>IP 地址</strong>：优先级相同时，IP 地址大的获胜。</li><li><strong>抢占（Preempt）</strong>：默认情况下，HSRP 关闭抢占。启用抢占后，高优先级的路由器可在上线后主动成为 Active。</li></ol></li></ul><h3 id="hsrp-版本差异" tabindex="-1">HSRP 版本差异 <a class="header-anchor" href="#hsrp-版本差异" aria-label="Permalink to &quot;HSRP 版本差异&quot;">​</a></h3><ul><li><strong>版本 1</strong>： <ul><li>组播地址：224.0.0.2</li><li>组编号范围：0-255</li></ul></li><li><strong>版本 2</strong>： <ul><li>组播地址：224.0.0.102</li><li>组编号范围：0-4095</li><li>支持 IPv6</li></ul></li></ul><h3 id="hsrp-拓扑示例" tabindex="-1">HSRP 拓扑示例 <a class="header-anchor" href="#hsrp-拓扑示例" aria-label="Permalink to &quot;HSRP 拓扑示例&quot;">​</a></h3><ul><li>下图中 R5 被选为 Active，R4 被选为 Standby： <img src="'+n+'" alt="hsrp_topology"></li></ul><h3 id="hsrp-其它报文示例" tabindex="-1">HSRP 其它报文示例 <a class="header-anchor" href="#hsrp-其它报文示例" aria-label="Permalink to &quot;HSRP 其它报文示例&quot;">​</a></h3><ul><li>手动将 R5 的 F0/1 接口关闭： <ul><li>R5 发送 Resign 报文，宣布辞职。</li><li>R2 和 R3 状态变为 Speak，开始竞选 Standby。</li><li>R4 成为 Active（coup），R3 成为新的 Standby。</li></ul></li></ul><p><img src="'+h+'" alt="hsrp_resign"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>我们在敲命令standby ip 10.10.10.1 例如在R2上敲了，在R3 R4 R5路由器上可以只敲standby ip 这样会学习过来R2上的 virtual ip。</p></div>',30)]))}const m=a(p,[["render",c]]);export{S as __pageData,m as default};
